define(()=>(()=>{"use strict";var e={56:(e,t,s)=>{e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function s(e){for(var s=-1,a=0;a<t.length;a++)if(t[a].identifier===e){s=a;break}return s}function a(e,a){for(var r={},o=[],i=0;i<e.length;i++){var d=e[i],l=a.base?d[0]+a.base:d[0],c=r[l]||0,u="".concat(l," ").concat(c);r[l]=c+1;var m=s(u),v={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==m)t[m].references++,t[m].updater(v);else{var p=n(v,a);a.byIndex=i,t.splice(i,0,{identifier:u,updater:p,references:1})}o.push(u)}return o}function n(e,t){var s=t.domAPI(t);return s.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;s.update(e=t)}else s.remove()}}e.exports=function(e,n){var r=a(e=e||[],n=n||{});return function(e){e=e||[];for(var o=0;o<r.length;o++){var i=s(r[o]);t[i].references--}for(var d=a(e,n),l=0;l<r.length;l++){var c=s(r[l]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}r=d}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},240:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(601),n=s.n(a),r=s(314),o=s.n(r)()(n());o.push([e.id,"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n#congeAppMain {\n  @apply flex flex-col items-center min-h-screen bg-gray-100 font-sans;\n}\n\n.alert-success, .alert-error {\n  @apply w-full max-w-4xl mx-auto my-4 p-4 rounded-lg text-center;\n}\n\n.alert-success {\n  @apply bg-green-100 text-green-800;\n}\n\n.alert-error {\n  @apply bg-red-100 text-red-800;\n}",""]);const i=o},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var s="",a=void 0!==t[5];return t[4]&&(s+="@supports (".concat(t[4],") {")),t[2]&&(s+="@media ".concat(t[2]," {")),a&&(s+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),s+=e(t),a&&(s+="}"),t[2]&&(s+="}"),t[4]&&(s+="}"),s}).join("")},t.i=function(e,s,a,n,r){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(a)for(var i=0;i<this.length;i++){var d=this[i][0];null!=d&&(o[d]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);a&&o[c[0]]||(void 0!==r&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=r),s&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=s):c[2]=s),n&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=n):c[4]="".concat(n)),t.push(c))}},t}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,s){var a=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(s)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(s){!function(e,t,s){var a="";s.supports&&(a+="@supports (".concat(s.supports,") {")),s.media&&(a+="@media ".concat(s.media," {"));var n=void 0!==s.layer;n&&(a+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),a+=s.css,n&&(a+="}"),s.media&&(a+="}"),s.supports&&(a+="}");var r=s.sourceMap;r&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,s)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function s(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={id:a,exports:{}};return e[a](r,r.exports,s),r.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.nc=void 0;var a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"congeAppMain"}},[t("div",{staticClass:"hero bg-gradient-to-r from-blue-700 to-blue-900 text-white py-12 px-4 md:px-8"},[t("div",{staticClass:"container mx-auto flex flex-col md:flex-row items-center justify-between"},[t("div",{staticClass:"hero-left mb-8 md:mb-0 md:w-1/2"},[t("h1",{staticClass:"text-4xl font-bold"},[e._v(e._s(e.translations.welcome)+", "+e._s(e.userName)+" !")]),e._v(" "),t("p",{staticClass:"mt-4 text-lg"},[e._v(e._s(e.translations.welcomeMessage))])]),e._v(" "),t("div",{staticClass:"hero-right md:w-1/2"},[t("conge-form",{on:{success:e.showSuccess,error:e.showError}})],1)])]),e._v(" "),t("div",{staticClass:"features py-12 px-4"},[t("conge-features")],1),e._v(" "),t("div",{staticClass:"conge-list py-12 px-4"},[t("conge-list",{on:{error:e.showError}})],1),e._v(" "),e.isAdmin?t("div",{staticClass:"admin-conge-list py-12 px-4"},[t("conge-admin-list",{on:{success:e.showSuccess,error:e.showError}})],1):e._e(),e._v(" "),e.successMessage?t("div",{staticClass:"alert alert-success"},[e._v(e._s(e.successMessage))]):e._e(),e._v(" "),e.errorMessage?t("div",{staticClass:"alert alert-error"},[e._v(e._s(e.errorMessage))]):e._e()])};a._withStripped=!0;const n={welcome:"Bienvenue",welcomeMessage:"Gérez vos demandes de congé et consultez celles de vos collègues.",dateDebut:"Date de début",dateFin:"Date de fin",typeConge:"Type de congé",selectType:"Sélectionnez un type de congé",vacances:"Vacances",maladie:"Congé maladie",autre:"Autre",motif:"Motif",submit:"Soumettre la demande",submitSuccess:"Demande soumise avec succès !",submitError:"Erreur lors de la soumission de la demande.",myDemandes:"Mes demandes",relationsDemandes:"Demandes de mes collègues",adminDemandes:"Toutes les demandes",status:"Statut",submittedAt:"Soumise le",actions:"Actions",approve:"Approuver",update:"Modifier",reject:"Refuser",cancel:"Annuler",save:"Enregistrer",cancelEdit:"Annuler la modification",approveSuccess:"Demande approuvée avec succès !",updateSuccess:"Demande mise à jour avec succès !",rejectSuccess:"Demande refusée avec succès !",cancelSuccess:"Demande annulée avec succès !",actionError:"Erreur lors de l’exécution de l’action.",fetchError:"Erreur lors de la récupération des demandes.",featuresTitle:"Fonctionnalités",feature1Title:"Soumettre une demande de congé",feature1Desc:"Soumettez facilement une demande de vacances, congé maladie ou autre via un formulaire simple.",feature2Title:"Consulter vos demandes",feature2Desc:"Suivez l’évolution de vos demandes et leurs statuts en temps réel.",feature3Title:"Voir les demandes des collègues",feature3Desc:"Consultez les demandes de congé de votre équipe pour mieux coordonner le travail.",feature4Title:"Gérer toutes les demandes",feature4Desc:"Les administrateurs peuvent approuver, modifier, refuser ou annuler les demandes.",totalDemandes:"Nombre total de demandes",approvedDemandes:"Demandes approuvées",pendingDemandes:"Demandes en attente",confirmApprove:"Êtes-vous sûr de vouloir approuver cette demande ?",confirmReject:"Êtes-vous sûr de vouloir refuser cette demande ?",confirmCancel:"Êtes-vous sûr de vouloir annuler cette demande ?"};function r(e,t,s,a,n,r,o,i){var d,l="function"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=s,l._compiled=!0),a&&(l.functional=!0),r&&(l._scopeId="data-v-"+r),o?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},l._ssrRegister=d):n&&(d=i?function(){n.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:n),d)if(l.functional){l._injectStyles=d;var c=l.render;l.render=function(e,t){return d.call(t),c(e,t)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,d):[d]}return{exports:e,options:l}}const o=r({data:()=>({translations:n,userName:eXo.env.portal.userName||"Utilisateur",isAdmin:!1,successMessage:"",errorMessage:""}),created(){this.checkAdmin()},methods:{checkAdmin(){fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/conges/enattente`,{method:"GET",credentials:"include"}).then(e=>{e.ok&&(this.isAdmin=!0)}).catch(()=>{this.isAdmin=!1})},showSuccess(e){this.successMessage=e,setTimeout(()=>this.successMessage="",5e3)},showError(e){this.errorMessage=e,setTimeout(()=>this.errorMessage="",5e3)}}},a,[],!1,null,null,null).exports;var i=function(){var e=this,t=e._self._c;return t("form",{staticClass:"space-y-4 bg-white p-6 rounded-lg shadow-lg",on:{submit:function(t){return t.preventDefault(),e.submitDemande.apply(null,arguments)}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.demande.dateDebut,expression:"demande.dateDebut"}],staticClass:"input input-bordered w-full",attrs:{type:"date",placeholder:e.translations.dateDebut,required:""},domProps:{value:e.demande.dateDebut},on:{input:function(t){t.target.composing||e.$set(e.demande,"dateDebut",t.target.value)}}}),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.demande.dateFin,expression:"demande.dateFin"}],staticClass:"input input-bordered w-full",attrs:{type:"date",placeholder:e.translations.dateFin,required:""},domProps:{value:e.demande.dateFin},on:{input:function(t){t.target.composing||e.$set(e.demande,"dateFin",t.target.value)}}}),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.demande.typeConge,expression:"demande.typeConge"}],staticClass:"select select-bordered w-full",attrs:{required:""},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.demande,"typeConge",t.target.multiple?s:s[0])}}},[t("option",{attrs:{value:"",disabled:""}},[e._v(e._s(e.translations.selectType))]),e._v(" "),t("option",{attrs:{value:"VACANCES"}},[e._v(e._s(e.translations.vacances))]),e._v(" "),t("option",{attrs:{value:"MALADIE"}},[e._v(e._s(e.translations.maladie))]),e._v(" "),t("option",{attrs:{value:"AUTRE"}},[e._v(e._s(e.translations.autre))])]),e._v(" "),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.demande.motif,expression:"demande.motif"}],staticClass:"textarea textarea-bordered w-full",attrs:{placeholder:e.translations.motif,required:""},domProps:{value:e.demande.motif},on:{input:function(t){t.target.composing||e.$set(e.demande,"motif",t.target.value)}}}),e._v(" "),t("button",{staticClass:"btn btn-primary w-full",attrs:{type:"submit"}},[e._v(e._s(e.translations.submit))])])};i._withStripped=!0;const d=r({data:()=>({translations:n,demande:{dateDebut:"",dateFin:"",typeConge:"",motif:""}}),methods:{submitDemande(){const e=`dateDebut=${encodeURIComponent(this.demande.dateDebut)}&dateFin=${encodeURIComponent(this.demande.dateFin)}&typeConge=${encodeURIComponent(this.demande.typeConge)}&motif=${encodeURIComponent(this.demande.motif)}`;fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/conges/submit`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}).then(e=>{if(!e.ok)throw new Error("Error submitting demande");this.$emit("success",this.translations.submitSuccess),this.demande={dateDebut:"",dateFin:"",typeConge:"",motif:""}}).catch(e=>{this.$emit("error",this.translations.submitError),console.error(e)})}}},i,[],!1,null,null,null).exports;var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"features container mx-auto py-12 px-4"},[t("h2",{staticClass:"text-3xl font-bold text-center text-blue-800 mb-8"},[e._v(e._s(e.translations.featuresTitle))]),e._v(" "),t("div",{staticClass:"steps steps-vertical md:steps-horizontal mb-12"},[t("div",{staticClass:"step step-primary"},[e._v(e._s(e.translations.feature1Title))]),e._v(" "),t("div",{staticClass:"step step-primary"},[e._v(e._s(e.translations.feature2Title))]),e._v(" "),t("div",{staticClass:"step step-primary"},[e._v(e._s(e.translations.feature3Title))]),e._v(" "),e.isAdmin?t("div",{staticClass:"step step-primary"},[e._v(e._s(e.translations.feature4Title))]):e._e()]),e._v(" "),t("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},[t("div",{staticClass:"card bg-white shadow-lg"},[t("div",{staticClass:"card-body"},[t("h3",{staticClass:"card-title"},[e._v(e._s(e.translations.feature1Title))]),e._v(" "),t("p",[e._v(e._s(e.translations.feature1Desc))])])]),e._v(" "),t("div",{staticClass:"card bg-white shadow-lg"},[t("div",{staticClass:"card-body"},[t("h3",{staticClass:"card-title"},[e._v(e._s(e.translations.feature2Title))]),e._v(" "),t("p",[e._v(e._s(e.translations.feature2Desc))])])]),e._v(" "),t("div",{staticClass:"card bg-white shadow-lg"},[t("div",{staticClass:"card-body"},[t("h3",{staticClass:"card-title"},[e._v(e._s(e.translations.feature3Title))]),e._v(" "),t("p",[e._v(e._s(e.translations.feature3Desc))])])]),e._v(" "),e.isAdmin?t("div",{staticClass:"card bg-white shadow-lg"},[t("div",{staticClass:"card-body"},[t("h3",{staticClass:"card-title"},[e._v(e._s(e.translations.feature4Title))]),e._v(" "),t("p",[e._v(e._s(e.translations.feature4Desc))])])]):e._e()])])};l._withStripped=!0;const c=r({data:()=>({translations:n,isAdmin:!1}),created(){this.checkAdmin()},methods:{checkAdmin(){fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/conges/enattente`,{method:"GET",credentials:"include"}).then(e=>{e.ok&&(this.isAdmin=!0)}).catch(()=>{this.isAdmin=!1})}}},l,[],!1,null,null,null).exports;var u=function(){var e=this,t=e._self._c;return t("div",{staticClass:"conge-list container mx-auto py-12 px-4"},[t("h2",{staticClass:"text-2xl font-bold text-blue-800 mb-6"},[e._v(e._s(e.translations.myDemandes))]),e._v(" "),t("div",{staticClass:"overflow-x-auto"},[t("table",{staticClass:"table w-full"},[t("thead",[t("tr",[t("th",[e._v(e._s(e.translations.dateDebut))]),e._v(" "),t("th",[e._v(e._s(e.translations.dateFin))]),e._v(" "),t("th",[e._v(e._s(e.translations.typeConge))]),e._v(" "),t("th",[e._v(e._s(e.translations.motif))]),e._v(" "),t("th",[e._v(e._s(e.translations.status))]),e._v(" "),t("th",[e._v(e._s(e.translations.submittedAt))])])]),e._v(" "),t("tbody",e._l(e.myDemandes.demandes,function(s,a){return t("tr",{key:a},[t("td",[e._v(e._s(s.dateDebut))]),e._v(" "),t("td",[e._v(e._s(s.dateFin))]),e._v(" "),t("td",[e._v(e._s(s.typeConge))]),e._v(" "),t("td",[e._v(e._s(s.motif))]),e._v(" "),t("td",[t("span",{class:{"badge badge-success":"APPROUVE"===s.status,"badge badge-warning":"EN_ATTENTE"===s.status,"badge badge-error":"REJETE"===s.status||"ANNULE"===s.status}},[e._v(e._s(s.status))])]),e._v(" "),t("td",[e._v(e._s(s.soumisLe||"N/A"))])])}),0)])]),e._v(" "),t("h2",{staticClass:"text-2xl font-bold text-blue-800 mt-12 mb-6"},[e._v(e._s(e.translations.relationsDemandes))]),e._v(" "),e._l(e.relationsDemandes,function(s,a){return t("div",{key:a},[t("h3",{staticClass:"text-xl font-semibold text-blue-700 mb-4"},[e._v(e._s(s.fullName)+" ("+e._s(s.userName)+")")]),e._v(" "),t("div",{staticClass:"overflow-x-auto"},[t("table",{staticClass:"table w-full"},[t("thead",[t("tr",[t("th",[e._v(e._s(e.translations.dateDebut))]),e._v(" "),t("th",[e._v(e._s(e.translations.dateFin))]),e._v(" "),t("th",[e._v(e._s(e.translations.typeConge))]),e._v(" "),t("th",[e._v(e._s(e.translations.motif))]),e._v(" "),t("th",[e._v(e._s(e.translations.status))]),e._v(" "),t("th",[e._v(e._s(e.translations.submittedAt))])])]),e._v(" "),t("tbody",e._l(s.demandes,function(s,a){return t("tr",{key:a},[t("td",[e._v(e._s(s.dateDebut))]),e._v(" "),t("td",[e._v(e._s(s.dateFin))]),e._v(" "),t("td",[e._v(e._s(s.typeConge))]),e._v(" "),t("td",[e._v(e._s(s.motif))]),e._v(" "),t("td",[t("span",{class:{"badge badge-success":"APPROUVE"===s.status,"badge badge-warning":"EN_ATTENTE"===s.status,"badge badge-error":"REJETE"===s.status||"ANNULE"===s.status}},[e._v(e._s(s.status))])]),e._v(" "),t("td",[e._v(e._s(s.soumisLe||"N/A"))])])}),0)])])])})],2)};u._withStripped=!0;const m=r({data:()=>({translations:n,myDemandes:{demandes:[]},relationsDemandes:[]}),created(){this.fetchMyDemandes(),this.fetchRelationsDemandes()},methods:{fetchMyDemandes(){fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/conges/my`,{method:"GET",credentials:"include"}).then(e=>{if(!e.ok)throw new Error("Error fetching my demandes");return e.json()}).then(e=>{this.myDemandes=e}).catch(e=>{this.$emit("error",this.translations.fetchError),console.error(e)})},fetchRelationsDemandes(){fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/conges/relations`,{method:"GET",credentials:"include"}).then(e=>{if(!e.ok)throw new Error("Error fetching relations demandes");return e.json()}).then(e=>{this.relationsDemandes=e}).catch(e=>{this.$emit("error",this.translations.fetchError),console.error(e)})}}},u,[],!1,null,null,null).exports;var v=function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-conge-list container mx-auto py-12 px-4"},[t("h2",{staticClass:"text-2xl font-bold text-blue-800 mb-6"},[e._v(e._s(e.translations.adminDemandes))]),e._v(" "),t("div",{staticClass:"stats shadow mb-8 grid grid-cols-1 md:grid-cols-3 gap-4"},[t("div",{staticClass:"stat"},[e._m(0),e._v(" "),t("div",{staticClass:"stat-title"},[e._v(e._s(e.translations.totalDemandes))]),e._v(" "),t("div",{staticClass:"stat-value"},[e._v(e._s(e.stats.total))])]),e._v(" "),t("div",{staticClass:"stat"},[e._m(1),e._v(" "),t("div",{staticClass:"stat-title"},[e._v(e._s(e.translations.approvedDemandes))]),e._v(" "),t("div",{staticClass:"stat-value"},[e._v(e._s(e.stats.approved))])]),e._v(" "),t("div",{staticClass:"stat"},[e._m(2),e._v(" "),t("div",{staticClass:"stat-title"},[e._v(e._s(e.translations.pendingDemandes))]),e._v(" "),t("div",{staticClass:"stat-value"},[e._v(e._s(e.stats.pending))])])]),e._v(" "),e._l(e.allDemandes,function(s,a){return t("div",{key:a},[t("h3",{staticClass:"text-xl font-semibold text-blue-700 mb-4"},[e._v(e._s(s.fullName)+" ("+e._s(s.userName)+")")]),e._v(" "),t("div",{staticClass:"overflow-x-auto"},[t("table",{staticClass:"table w-full"},[t("thead",[t("tr",[t("th",[e._v(e._s(e.translations.dateDebut))]),e._v(" "),t("th",[e._v(e._s(e.translations.dateFin))]),e._v(" "),t("th",[e._v(e._s(e.translations.typeConge))]),e._v(" "),t("th",[e._v(e._s(e.translations.motif))]),e._v(" "),t("th",[e._v(e._s(e.translations.status))]),e._v(" "),t("th",[e._v(e._s(e.translations.submittedAt))]),e._v(" "),t("th",[e._v(e._s(e.translations.actions))])])]),e._v(" "),t("tbody",e._l(s.demandes,function(a,n){return t("tr",{key:n},[t("td",[e._v(e._s(a.dateDebut))]),e._v(" "),t("td",[e._v(e._s(a.dateFin))]),e._v(" "),t("td",[e._v(e._s(a.typeConge))]),e._v(" "),t("td",[e._v(e._s(a.motif))]),e._v(" "),t("td",[t("span",{class:{"badge badge-success":"APPROUVE"===a.status,"badge badge-warning":"EN_ATTENTE"===a.status,"badge badge-error":"REJETE"===a.status||"ANNULE"===a.status}},[e._v(e._s(a.status))])]),e._v(" "),t("td",[e._v(e._s(a.submittedAt||"N/A"))]),e._v(" "),t("td",{staticClass:"space-x-2"},["EN_ATTENTE"===a.status?t("button",{staticClass:"btn btn-success btn-sm",on:{click:function(t){return e.openConfirmModal("approve",s.userName,n)}}},[e._v(e._s(e.translations.approve))]):e._e(),e._v(" "),"EN_ATTENTE"===a.status?t("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(t){return e.openUpdateForm(s.userName,n,a)}}},[e._v(e._s(e.translations.update))]):e._e(),e._v(" "),"EN_ATTENTE"===a.status?t("button",{staticClass:"btn btn-error btn-sm",on:{click:function(t){return e.openConfirmModal("reject",s.userName,n)}}},[e._v(e._s(e.translations.reject))]):e._e(),e._v(" "),"EN_ATTENTE"===a.status?t("button",{staticClass:"btn btn-secondary btn-sm",on:{click:function(t){return e.openConfirmModal("cancel",s.userName,n)}}},[e._v(e._s(e.translations.cancel))]):e._e()])])}),0)])]),e._v(" "),e.editing&&e.editing.userName===s.userName&&e.editing.index===e.index?t("form",{staticClass:"mt-4 space-y-4 bg-white p-6 rounded-lg shadow-lg",on:{submit:function(t){return t.preventDefault(),e.updateDemande.apply(null,arguments)}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.editing.demande.dateDebut,expression:"editing.demande.dateDebut"}],staticClass:"input input-bordered w-full",attrs:{type:"date",required:""},domProps:{value:e.editing.demande.dateDebut},on:{input:function(t){t.target.composing||e.$set(e.editing.demande,"dateDebut",t.target.value)}}}),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.editing.demande.dateFin,expression:"editing.demande.dateFin"}],staticClass:"input input-bordered w-full",attrs:{type:"date",required:""},domProps:{value:e.editing.demande.dateFin},on:{input:function(t){t.target.composing||e.$set(e.editing.demande,"dateFin",t.target.value)}}}),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.editing.demande.typeConge,expression:"editing.demande.typeConge"}],staticClass:"select select-bordered w-full",attrs:{required:""},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.editing.demande,"typeConge",t.target.multiple?s:s[0])}}},[t("option",{attrs:{value:"",disabled:""}},[e._v(e._s(e.translations.selectType))]),e._v(" "),t("option",{attrs:{value:"VACANCES"}},[e._v(e._s(e.translations.vacances))]),e._v(" "),t("option",{attrs:{value:"MALADIE"}},[e._v(e._s(e.translations.maladie))]),e._v(" "),t("option",{attrs:{value:"AUTRE"}},[e._v(e._s(e.translations.autre))])]),e._v(" "),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.editing.demande.motif,expression:"editing.demande.motif"}],staticClass:"textarea textarea-bordered w-full",attrs:{required:""},domProps:{value:e.editing.demande.motif},on:{input:function(t){t.target.composing||e.$set(e.editing.demande,"motif",t.target.value)}}}),e._v(" "),t("div",{staticClass:"flex space-x-4"},[t("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v(e._s(e.translations.save))]),e._v(" "),t("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(t){e.editing=null}}},[e._v(e._s(e.translations.cancelEdit))])])]):e._e()])}),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.showModal,expression:"showModal"}],staticClass:"modal-toggle",attrs:{type:"checkbox",id:e.modalId},domProps:{checked:Array.isArray(e.showModal)?e._i(e.showModal,null)>-1:e.showModal},on:{change:function(t){var s=e.showModal,a=t.target,n=!!a.checked;if(Array.isArray(s)){var r=e._i(s,null);a.checked?r<0&&(e.showModal=s.concat([null])):r>-1&&(e.showModal=s.slice(0,r).concat(s.slice(r+1)))}else e.showModal=n}}}),e._v(" "),t("div",{staticClass:"modal"},[t("div",{staticClass:"modal-box"},[t("h3",{staticClass:"font-bold text-lg"},[e._v(e._s(e.modalTitle))]),e._v(" "),t("p",{staticClass:"py-4"},[e._v(e._s(e.modalMessage))]),e._v(" "),t("div",{staticClass:"modal-action"},[t("button",{staticClass:"btn btn-primary",on:{click:e.confirmAction}},[e._v(e._s(e.translations.confirm))]),e._v(" "),t("button",{staticClass:"btn btn-secondary",on:{click:function(t){e.showModal=!1}}},[e._v(e._s(e.translations.cancel))])])])])],2)};v._withStripped=!0;const p=r({data:()=>({translations:n,allDemandes:[],editing:null,showModal:!1,modalId:"confirmModal",modalTitle:"",modalMessage:"",pendingAction:null,stats:{total:0,approved:0,pending:0}}),created(){this.fetchAllDemandes()},methods:{fetchAllDemandes(){fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/conges/all`,{method:"GET",credentials:"include"}).then(e=>{if(!e.ok)throw new Error("Error fetching all demandes");return e.json()}).then(e=>{this.allDemandes=e,this.calculateStats()}).catch(e=>{this.$emit("error",this.translations.fetchError),console.error(e)})},calculateStats(){let e=0,t=0,s=0;this.allDemandes.forEach(a=>{e+=a.demandes.length,a.demandes.forEach(e=>{"APPROUVE"===e.status&&t++,"EN_ATTENTE"===e.status&&s++})}),this.stats={total:e,approved:t,pending:s}},openConfirmModal(e,t,s){this.pendingAction={action:e,userName:t,index:s},this.modalTitle=this.translations[e],this.modalMessage=this.translations[`confirm${e.charAt(0).toUpperCase()+e.slice(1)}`],this.showModal=!0},confirmAction(){const{action:e,userName:t,index:s}=this.pendingAction;this[`${e}Demande`](t,s),this.showModal=!1},approveDemande(e,t){fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/conges/approve`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`userName=${encodeURIComponent(e)}&index=${t}`}).then(e=>{if(!e.ok)throw new Error("Error approving demande");this.$emit("success",this.translations.approveSuccess),this.fetchAllDemandes()}).catch(e=>{this.$emit("error",this.translations.actionError),console.error(e)})},openUpdateForm(e,t,s){this.editing={userName:e,index:t,demande:{...s}}},updateDemande(){const e=`userName=${encodeURIComponent(this.editing.userName)}&index=${this.editing.index}&dateDebut=${encodeURIComponent(this.editing.demande.dateDebut)}&dateFin=${encodeURIComponent(this.editing.demande.dateFin)}&typeConge=${encodeURIComponent(this.editing.demande.typeConge)}&motif=${encodeURIComponent(this.editing.demande.motif)}`;fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/conges/update`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}).then(e=>{if(!e.ok)throw new Error("Error updating demande");this.$emit("success",this.translations.updateSuccess),this.editing=null,this.fetchAllDemandes()}).catch(e=>{this.$emit("error",this.translations.actionError),console.error(e)})},rejectDemande(e,t){fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/conges/reject`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`userName=${encodeURIComponent(e)}&index=${t}`}).then(e=>{if(!e.ok)throw new Error("Error rejecting demande");this.$emit("success",this.translations.rejectSuccess),this.fetchAllDemandes()}).catch(e=>{this.$emit("error",this.translations.actionError),console.error(e)})},cancelDemande(e,t){fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/conges/cancel`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`userName=${encodeURIComponent(e)}&index=${t}`}).then(e=>{if(!e.ok)throw new Error("Error canceling demande");this.$emit("success",this.translations.cancelSuccess),this.fetchAllDemandes()}).catch(e=>{this.$emit("error",this.translations.actionError),console.error(e)})}}},v,[function(){var e=this._self._c;return e("div",{staticClass:"stat-figure text-primary"},[e("i",{staticClass:"fas fa-list fa-2x"})])},function(){var e=this._self._c;return e("div",{staticClass:"stat-figure text-success"},[e("i",{staticClass:"fas fa-check-circle fa-2x"})])},function(){var e=this._self._c;return e("div",{staticClass:"stat-figure text-warning"},[e("i",{staticClass:"fas fa-hourglass-half fa-2x"})])}],!1,null,null,null).exports,_={"conge-main":o,"conge-form":d,"conge-features":c,"conge-list":m,"conge-admin-list":p};for(const e in _)Vue.component(e,_[e]);var h=s(72),f=s.n(h),g=s(825),b=s.n(g),C=s(659),y=s.n(C),x=s(56),w=s.n(x),E=s(540),D=s.n(E),A=s(113),T=s.n(A),$=s(240),N={};N.styleTagTransform=T(),N.setAttributes=w(),N.insert=y().bind(null,"head"),N.domAPI=b(),N.insertStyleElement=D(),f()($.A,N),$.A&&$.A.locals&&$.A.locals;const M=eXo&&eXo.env&&eXo.env.portal&&eXo.env.portal.language||"en",S=`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.demandeCongeApp-${M}.json`;return exoi18n.loadLanguageAsync(M,S).then(e=>{new Vue({render:e=>e(o),i18n:e}).$mount("#demandeCongeApp")}),setInterval(()=>{vm.$children[0].$children.forEach(e=>{e.fetchMyDemandes&&e.fetchMyDemandes(),e.fetchRelationsDemandes&&e.fetchRelationsDemandes(),e.fetchAllDemandes&&e.fetchAllDemandes()})},3e3),{}})());